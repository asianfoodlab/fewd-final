<!doctype HTML>
<html>
<head>
	<title>Travel Itinerary Builder</title>
	<link rel="stylesheet" href="style.css" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script src="https://cdn.firebase.com/js/client/2.3.2/firebase.js"></script>
	<script src="node_modules/oauth-signature/dist/oauth-signature.js"></script>
</head>
<body>
	<div class="header">
      	<div class="logo">
          	<p>Logo</p>
     	</div>
      	<div class="topNav">
          	<ul>
	              <li><a href="index.html">Home</a></li>
	              <li><a href="about.html">About</a></li>
	              <li><a href="myitineraries.html">My Itineraries</a></li>
	              <li><a href="signin.html">Sign In</a></li>
          	</ul>
      	</div>
      	<div id="header">
      		<h1>Plan your Trip</h1>
      	</div>
	  	<div id="itineraryName">
	  		<input type="text" size="30" placeholder="Enter a name for your new itinerary" required>
	  	</div>
	  
	  	<div id="addManualItem">
	  		<h3>Manual Add</h3>
	  		<select id="itemType">
			  <option value="Accommodation">Accommodation</option>
			  <option value="Activity">Activity</option>
			  <option value="Restaurant">Restaurant</option>
			  <option value="Transportation">Transportation</option>
			</select>
	  		<input id="itemDescription" type="text" size="30" placeholder="Enter description" required>
	  		<input id="itemAddress" type="text" size="30" placeholder="Enter address">
	  		<input id="itemHours" type="text" size="30" placeholder="Enter hours of operation">
	  		<input id="itemPrice" type="text" size="30" placeholder="Enter price">
	    	<input id="addToPlanButton" type="button" value="Add to Plan">
 	    	
		</div>

		<div id="addYelpItem">
	  		<h3>Search Yelp</h3>
	  		<input id="searchTerm" type="text" size="80" placeholder="Search for activities, transportation, lodging, restaurants ..." required>
	    	<input id="searchButton" type="button" value="Search">
	  	</div> 
		</div>

      	<div id="mainTable">
      		<p id="planTable"></p>

	      	<script type="text/javascript">
		      	$(function(){
					var searchTerm;
					$("#searchButton").click(function(){
						searchTerm = $("#searchTerm")[0].value;
						console.log("searchTerm", searchTerm);

						// $.get("https://api.yelp.com/v2/search?term="+searchTerm+"&location=San+Francisco"&oauth_consumer_key=BpEX5TyDuwi9wsVZXENU8g&oauth_token=nnch734d00sl2jdk&oauth_signature_method=HMAC-SHA1&oauth_signature=tR3%2BTy81lMeYAr%2FFid0kMTYa%2FWM%3D&oauth_timestamp=1191242096&oauth_nonce=kllo9940pd9333jh&oauth_version=1.0, function(data){
						// 	console.log("data", data);	
						// });

						var httpMethod = 'GET',
	    				url = 'https://api.yelp.com/v2/search?term="+searchTerm+"&location=San+Francisco',
						parameters = {
					        oauth_consumer_key : 'BpEX5TyDuwi9wsVZXENU8g',
					        oauth_token : 'uUR_Rky_hODWwWVrPYBJEu2TETN8gfdX',
					        oauth_nonce : 'kllo9940pd9333jh',
					        oauth_timestamp : '1191242096',
					        oauth_signature_method : 'HMAC-SHA1',
					        oauth_version : '1.0',
					        term : searchTerm,
					        location : 'San Francisco'
					    },
					    consumerSecret = 'kT7Q5fYqA3qTF0ll8JDVEDWnc-A',
					    tokenSecret = '4lsUndzpyPzQCDcKMBwnRHipP9s',
					    // generates a RFC 3986 encoded, BASE64 encoded HMAC-SHA1 hash
					    encodedSignature = oauthSignature.generate(httpMethod, url, parameters, consumerSecret, tokenSecret),
					    // generates a BASE64 encode HMAC-SHA1 hash
					    signature = oauthSignature.generate(httpMethod, url, parameters, consumerSecret, tokenSecret,
					        { encodeSignature: false});
					    console.log("encodedSignature", encodedSignature);
					    console.log("signature", signature);

					    var nonce = function(length) {
						    var text = "";
						    var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
						    for(var i = 0; i < length; i++) {
						        text += possible.charAt(Math.floor(Math.random() * possible.length));
						    }
						    return text;
						    console.log("text", text);
						};

						var runNonce = nonce(16);
						console.log("nonce", runNonce);

					    $.get("https://api.yelp.com/v2/search?term="+searchTerm+"
					    	&location=San+Francisco
					    	&oauth_consumer_key=BpEX5TyDuwi9wsVZXENU8g&oauth_token=nnch734d00sl2jdk
					    	&oauth_signature_method=HMAC-SHA1
					    	&oauth_signature="+encodedSignature+"
					    	&oauth_timestamp=1191242096
					    	&oauth_nonce="+runNonce+"
					    	&oauth_version=1.0", 
					    	function(data){
								console.log("data", data);	
						});
					    

					});	//searchButton function

				});

	    		$(function(){
					var itemType;
					var description;
					var address;
					var hours;
					var price;
					$("#addToPlanButton").click(function(){
						itemType = $('#itemType').val();
						description = $("#itemDescription")[0].value;
						address = $("#itemAddress")[0].value;
						hours = $("#itemHours")[0].value;
						price = $("#itemPrice")[0].value;
						console.log("description", description);
						console.log("itemType", itemType);
						console.log("address", address);
						$('#planTable').append("<p>"+itemType+ " " +description+" " +address+ " " +hours+ " " +price+ "</p>");

						$('#itemType').val('');
						$("#itemDescription")[0].value = '';
						$("#itemAddress")[0].value='';
						$("#itemHours")[0].value='';
						$("#itemPrice")[0].value='';

						// $.get("https://api.yelp.com/v2/search?term="+searchTerm+"&location=San+Francisco", function(data){
						// 	console.log("data", data);	
						//});

					});	

				});

			// function addTodoItem(){
			// 	console.log("Inside function");
			// 	event.preventDefault();
			// 	var li = document.createElement("li");
			// 	var label = document.createElement("label");
			// 	var checkbox = document.createElement("input");
			// 	checkbox.type = "checkbox";
			// 	var item = document.getElementById("item");
			// 	var list = document.getElementById("todolist");
				
			// 	var textNode = document.createTextNode(item.value);
			// 	label.appendChild(textNode);
			// 	li.appendChild(label);
			// 	list.appendChild(li);
			// 	label.appendChild(checkbox);
			// 	item.value = "";
			// };

      	</script>
      	</div>
    </div>
</body>
</html>